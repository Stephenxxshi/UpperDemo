# Tag 值转换表达式说明（业务层）

## 目标
在业务标签映射中，为每个 Tag 增加可选的“源值 -> 目标值”转换表达式能力。

## 配置字段
在 `Configs/Lines/Tags/*.csv` 中使用可选列：
- `ValueTransformExpression`

并建议同时配置：
- `DataType`（用于转换结果强类型化）

未配置时，系统保持原始值不变。

## 变量与写法
表达式变量支持：`value` / `x` / `source`（三者等价）。

示例：
- `value * 0.1`
- `x + 100`
- `source / 60`
- `=1`（等价于 `value = 1`，可用于触发位转布尔）

## 生效时机
转换在业务层和 UI 层执行，通信层只提供原始值。

## 异常处理
- 表达式执行失败时，自动回退为原始值。
- 同一 Tag + 表达式组合仅记录一次告警日志，避免刷屏。

## 注意事项
- 表达式结果会按标签 `DataType` 自动转换。
- 当 `ArrayLength > 1` 且非字符串时，默认不对数组逐项转换（保持原值）。
