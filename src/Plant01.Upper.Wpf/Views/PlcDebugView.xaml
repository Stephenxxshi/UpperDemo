<UserControl
    x:Class="Plant01.Upper.Wpf.Views.PlcDebugView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="clr-namespace:Plant01.Upper.Presentation.Core.ViewModels;assembly=Plant01.Upper.Presentation.Core"
    d:DataContext="{d:DesignInstance vm:PlcDebugViewModel}"
    d:DesignHeight="600"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="10">
            <!-- S7 Connection Test -->
            <GroupBox Header="S7 Connection Test" Margin="0,0,0,10" Padding="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="IP:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Column="1" Text="{Binding S7IpAddress}" Margin="0,0,10,0"/>

                    <TextBlock Grid.Column="2" Text="Port:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Column="3" Text="{Binding S7Port}" Margin="0,0,10,0"/>

                    <TextBlock Grid.Column="4" Text="Rack:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Column="5" Text="{Binding S7Rack}" Margin="0,0,10,0"/>

                    <TextBlock Grid.Column="6" Text="Slot:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Column="7" Text="{Binding S7Slot}" Margin="0,0,10,0"/>

                    <Button Grid.Column="8" Content="Test Connection" Command="{Binding TestS7ConnectionCommand}"/>

                    <TextBlock Grid.Row="1" Grid.ColumnSpan="9" Margin="0,10,0,0" 
                               Text="{Binding ConnectionStatus, StringFormat='Status: {0}'}" 
                               FontWeight="Bold"/>
                </Grid>
            </GroupBox>

            <!-- Tag Generation from Rules -->
            <GroupBox Header="Generate Tags from Rules" Margin="0,0,0,10" Padding="10">
                <StackPanel>
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="DB:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox Grid.Column="1" Text="{Binding RuleDbNumber}" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="2" Text="Template:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox Grid.Column="3" Text="{Binding RuleNameTemplate}" Margin="0,0,10,0"/>

                        <TextBlock Grid.Column="4" Text="Start Offset:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBox Grid.Column="5" Text="{Binding RuleStartOffset}" Margin="0,0,10,0"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Count:" VerticalAlignment="Center" Margin="0,10,5,0"/>
                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding RuleCount}" Margin="0,10,10,0"/>

                        <TextBlock Grid.Row="1" Grid.Column="2" Text="Stride:" VerticalAlignment="Center" Margin="0,10,5,0"/>
                        <TextBox Grid.Row="1" Grid.Column="3" Text="{Binding RuleStride}" Margin="0,10,10,0"/>

                        <TextBlock Grid.Row="1" Grid.Column="4" Text="Type:" VerticalAlignment="Center" Margin="0,10,5,0"/>
                        <ComboBox Grid.Row="1" Grid.Column="5" Text="{Binding RuleDataType}" Margin="0,10,10,0" IsEditable="True">
                            <ComboBoxItem Content="Int16"/>
                            <ComboBoxItem Content="Int32"/>
                            <ComboBoxItem Content="Float"/>
                            <ComboBoxItem Content="Boolean"/>
                        </ComboBox>
                    </Grid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Preview" Command="{Binding PreviewTagsFromRulesCommand}" Margin="0,0,10,0"/>
                        <Button Content="Generate &amp; Merge" Command="{Binding GenerateTagsFromRulesCommand}"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <!-- Tag Generation from Schema -->
            <GroupBox Header="Generate Tags from Schema" Margin="0,0,0,10" Padding="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Text="DB Number:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBox Grid.Column="1" Text="{Binding SchemaDbNumber}" Margin="0,0,10,0"/>
                    
                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <Button Content="Preview" Command="{Binding PreviewTagsFromSchemaCommand}" Margin="0,0,10,0"/>
                        <Button Content="Generate &amp; Merge" Command="{Binding GenerateTagsFromSchemaCommand}"/>
                    </StackPanel>
                </Grid>
            </GroupBox>

            <!-- Tag Generation from TIA DB File -->
            <GroupBox Header="Generate Tags from TIA DB Text" Margin="0,0,0,10" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBox Height="100" 
                             AcceptsReturn="True" 
                             VerticalScrollBarVisibility="Auto" 
                             Text="{Binding TiaDbContent}" 
                             Margin="0,0,0,10"
                             FontFamily="Consolas"/>
                    
                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Content="Preview" Command="{Binding PreviewTagsFromTiaDbCommand}" Margin="0,0,10,0"/>
                        <Button Content="Generate &amp; Merge" Command="{Binding GenerateTagsFromTiaDbCommand}"/>
                    </StackPanel>
                </Grid>
            </GroupBox>

            <!-- Preview List -->
            <GroupBox Header="Preview Tags" Padding="10">
                <DataGrid ItemsSource="{Binding PreviewTags}" AutoGenerateColumns="True" Height="200" CanUserAddRows="False"/>
            </GroupBox>
        </StackPanel>
    </ScrollViewer>
</UserControl>
