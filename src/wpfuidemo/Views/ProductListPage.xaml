<UserControl x:Class="wpfuidemo.Views.ProductListPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:ui="clr-namespace:Plant01.WpfUI.Controls;assembly=Plant01.WpfUI"
      xmlns:local="clr-namespace:wpfuidemo.Views"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="800">

    <ui:EntityListLayout TotalCount="{Binding TotalCount}"
                         PageIndex="{Binding PageIndex, Mode=TwoWay}"
                         PageSize="{Binding PageSize, Mode=TwoWay}"
                         IsLoading="{Binding IsLoading}"
                         Title="产品列表"
                         SelectedCount="{Binding SelectedCount}"
                         RefreshCommand="{Binding RefreshCommand}">
        <!-- Basic Filter -->
        <ui:EntityListLayout.FilterContent>
            <WrapPanel>
                <ui:AntInput Width="200" Placeholder="请输入产品名称" 
                             Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             Margin="0,0,8,0"/>
                <ui:AntSelect Width="120" Placeholder="分类"
                              SelectedValue="{Binding Filter.Category}"
                              SelectedValuePath="Tag"
                              Margin="0,0,8,0">
                    <ui:AntSelect.Items>
                        <ComboBoxItem Content="Electronics" Tag="Electronics"/>
                        <ComboBoxItem Content="Clothing" Tag="Clothing"/>
                        <ComboBoxItem Content="Food" Tag="Food"/>
                    </ui:AntSelect.Items>
                </ui:AntSelect>
                <ui:AntButton Content="查询" Type="Primary" Command="{Binding LoadDataCommand}" Margin="0,0,8,0"/>
                <ui:AntButton Content="重置" Command="{Binding ResetFilterCommand}"/>
            </WrapPanel>
        </ui:EntityListLayout.FilterContent>

        <!-- Advanced Filter -->
        <ui:EntityListLayout.AdvancedFilterContent>
            <WrapPanel>
                <ui:AntDatePicker Placeholder="开始日期" SelectedDate="{Binding Filter.StartDate}" Margin="0,0,8,0"/>
                <ui:AntDatePicker Placeholder="结束日期" SelectedDate="{Binding Filter.EndDate}" Margin="0,0,8,0"/>
            </WrapPanel>
        </ui:EntityListLayout.AdvancedFilterContent>

        <!-- Actions -->
        <ui:EntityListLayout.ActionContent>
            <ui:AntButton Content="新建产品" Type="Primary" Command="{Binding CreateCommand}"/>
        </ui:EntityListLayout.ActionContent>

        <!-- Batch Actions -->
        <ui:EntityListLayout.BatchActionContent>
            <ui:AntButton Content="批量删除" Type="Primary" Danger="True" Command="{Binding BatchDeleteCommand}"/>
        </ui:EntityListLayout.BatchActionContent>

        <!-- Content -->
        <ui:AntDataGrid ItemsSource="{Binding Items}" AutoGenerateColumns="False" IsReadOnly="True">
            <DataGrid.Columns>
                <DataGridTemplateColumn Width="40">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ui:AntCheckbox IsChecked="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" HorizontalAlignment="Center"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                <DataGridTextColumn Header="名称" Binding="{Binding Name}" Width="*"/>
                <DataGridTextColumn Header="分类" Binding="{Binding Category}" Width="100"/>
                <DataGridTextColumn Header="价格" Binding="{Binding Price, StringFormat=C}" Width="100"/>
                <DataGridTextColumn Header="创建时间" Binding="{Binding CreateTime, StringFormat=yyyy-MM-dd}" Width="120"/>
                
                <DataGridTemplateColumn Header="操作" Width="150">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <ui:AntButton Content="编辑" Type="Link" 
                                              Command="{Binding DataContext.EditCommand, RelativeSource={RelativeSource AncestorType=ui:EntityListLayout}}" 
                                              CommandParameter="{Binding}"/>
                                <ui:AntDivider Orientation="Vertical" Margin="4,0"/>
                                <ui:AntButton Content="删除" Type="Link" Danger="True"
                                              Command="{Binding DataContext.DeleteCommand, RelativeSource={RelativeSource AncestorType=ui:EntityListLayout}}" 
                                              CommandParameter="{Binding}"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </ui:AntDataGrid>
    </ui:EntityListLayout>
</UserControl>
